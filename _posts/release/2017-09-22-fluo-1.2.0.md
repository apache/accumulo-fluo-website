---
title: Apache Fluo 1.2.0 released
date: 2017-09-22 15:00:00 +0000
version: fluo-1.2.0
draft: true
---

Below are resources for this release:

 * Download a release tarball and verify by these [procedures] using these [KEYS]
 
   | [fluo-1.2.0-bin.tar.gz][bin-release]            | [ASC][bin-asc] [MD5][bin-md5] [SHA][bin-sha] |
   | [fluo-1.2.0-source-release.tar.gz][src-release] | [ASC][src-asc] [MD5][src-md5] [SHA][src-sha] |
 * View the [documentation][docs] for this release.
 * Read the [Javadocs][javadocs].
 
Apache Fluo follows [semver](http://semver.org/) for its API . The API consists
of everything under the `org.apache.fluo.api` package. Code outside of this
package can change at any time. If your project is using Fluo code that falls
outside of the API, then consider [initiating a discussion](/getinvolved/)
about adding it to the API.

## Significant changes

The major changes in 1.2.0 are highlighted here, for the complete list of changes, see the [1.2.0
Milestone] on Github.

### Fluo now supports multiple ways for running Fluo applications

Before 1.2.0, Fluo applications could only be run in YARN or as local processes. For 1.2.0, the Fluo tarball
was refactored to support other ways of running Fluo applications such as Docker, Kubernetes & Marathon. This
refactoring has the following notable changes:

* The Fluo tarball is now designed for only initializing Fluo and running local processes.
* The `fluo.properties` configuration file was deprecated and was replaced by `fluo-conn.properties` and `fluo-app.properties`.
  - `fluo-conn.properties` contains connection properties and is shared by Fluo applications
  - `fluo-app.properites` contains application-specific properties and is only used during initialization of Fluo applications.
* Code for launching Fluo applications in YARN was moved to its [own project][fluo-yarn] that has its own
  [release][fluo-yarn-release] tarball. The Fluo tarball can still be used to launch Fluo applications
  in YARN if a `fluo.properties` is created from `fluo.properties.deprecated`.
* Fluo application jars are now stored in HDFS and application configuration is now stored in Zookeeper.  This information used to be stored in a local directory.  This change made running Fluo different ways (like YARN or Docker) possible.

Read the [quickstart documentation][quickstart] to learn how to run Fluo applications using these new methods.

### Fluo now supports read locks.

The Percolator paper stated that read locks were expensive and usually not
needed.  Therefore in Percolator reads did not acquire a read lock.  This
assessment is correct, not every read should acquire a read lock.  However,
offering the ability to optionally obtain a read lock makes writing certain
applications much simpler.  So in this release of Fluo, optional read locks
were added. Below is an example of how to acquire read locks.

```java
  void addEdge(FluoClient client, String node1, String node2) {
    try(Transaction tx = client.newTransaction()) {

      // These reads acquire a read lock.  Any concurrent changes will cause this
      // transaction to fail.
      String a1 = tx.withReadLock().gets(node1, new Column("node","alias"));
      String a2 = tx.withReadLock().gets(node2, new Column("node","alias"));

      tx.set("e:"+a1+":"+a2, new Column("edge", "exists"), "Y");
    }
  }

  void setAlias(FluoClient client, String node, String newAlias) {
    try(Transaction tx = client.newTransaction()) {
      String oldAlias = tx.gets(node, new Column("node","alias"));
      tx.set(node, new Column("node","alias"), newAlias);

      updateExistingEdges(oldAlias, newAlias);
    }
  }

```

Concurrent calls to `addEdge(client,"n1","n2")` and `addEdge(client,"n1","n3")`
can run without issue.  However, concurrent calls to
`addEdge(client,"n1","n2")` and `setAlias(client, "n1","a5")` will result in a
collision.  If `addEdge` did not obtain a read lock, then it would not collide
with `setAlias`.  If `addEdge` obtained a write lock, then concurrent calls to
`addEdge` could needlessly collide.

See the [withReadLock javadoc][readlock] for more information.

### Asynchronous commit code refactored for readability.

Fluo's commit code is asynchronous in order to support high throughput.
Before this release the high level commit logic was spread far and wide in the
code.  For this release the commit code was transitioned from Guava's
ListenableFutre to Java 8's CompletableFuture in [#722].  This transition laid
the ground work for [#978] which centralized the commit logic.  Now the high
level logic for the commit code is all in one place, making it much easier to
understand.

### Addition of Fluo remove command.

Fluo now offers a command to remove an applications data in Zookeeper and
Accumulo. Work on this issue was done in [#991].

### Shading libthrift

Fluo uses Apache Thrift for remote procedure calls.  Projects using Thrift use
its compiler to generate code.  This generated Java code make calls to
libthrift which is an artifact release by the Thrift project.  The code
generated by a specific version of Thrift is only guaranteed to work with the
same version of libthrift.  For example, code generated by the Thrift 0.9.1
compiler is only guaranteed to work with libthrift 0.9.1.

Accumulo also uses Thrift for its RPCs.  When Accumulo and Fluo use different
versions of thrift it can cause serious problems. To avoid these problems,
in [#995] libthrift was shaded and relocated into the fluo-core jar eliminating Fluo's
external dependency on libthrift.  This means that no matter which version
Accumulo uses, it will not conflict with Fluo's version.

### Minimum Accumulo version.

In [#960] Fluo started using some Accumulo APIs introduced in 1.7.0.  Therefore
Accumulo 1.7.0 is the minimum supported version of Accumulo.

## Testing
 
[procedures]: https://www.apache.org/info/verification
[KEYS]: https://www.apache.org/dist/fluo/KEYS
[bin-release]: https://www.apache.org/dyn/closer.lua/fluo/fluo/1.2.0/fluo-1.2.0-bin.tar.gz
[bin-asc]: https://www.apache.org/dist/fluo/fluo/1.2.0/fluo-1.2.0-bin.tar.gz.asc
[bin-md5]: https://www.apache.org/dist/fluo/fluo/1.2.0/fluo-1.2.0-bin.tar.gz.md5
[bin-sha]: https://www.apache.org/dist/fluo/fluo/1.2.0/fluo-1.2.0-bin.tar.gz.sha
[src-release]: https://www.apache.org/dyn/closer.lua/fluo/fluo/1.2.0/fluo-1.2.0-source-release.tar.gz
[src-asc]: https://www.apache.org/dist/fluo/fluo/1.2.0/fluo-1.2.0-source-release.tar.gz.asc
[src-md5]: https://www.apache.org/dist/fluo/fluo/1.2.0/fluo-1.2.0-source-release.tar.gz.md5
[src-sha]: https://www.apache.org/dist/fluo/fluo/1.2.0/fluo-1.2.0-source-release.tar.gz.sha
[javadocs]: {{ site.fluo_api_base }}/1.2.0/
[docs]: /docs/fluo/1.2/
[semver]: http://semver.org/
[1.2.0 Milestone]: https://github.com/apache/fluo/milestone/6?closed=1
[fluo-yarn]: https://github.com/apache/fluo-yarn
[fluo-yarn-release]: https://fluo.apache.org/release/fluo-yarn-1.0.0
[fluo]: https://github.com/apache/fluo
[quickstart]: https://fluo.apache.org/docs/fluo/1.2/getting-started/quick-start
[#722]: https://github.com/apache/fluo/issues/722
[842]: https://github.com/apache/fluo/issues/842
[#960]: https://github.com/apache/fluo/issues/960
[#978]: https://github.com/apache/fluo/issues/978
[#991]: https://github.com/apache/fluo/issues/991
[#995]: https://github.com/apache/fluo/issues/995
[readlock]: {{ site.fluo_api_static }}/{{ site.latest_fluo_release }}/org/apache/fluo/api/client/TransactionBase.html#withReadLock--
